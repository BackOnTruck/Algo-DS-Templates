### 拟阵

拟阵用于解决一些**贪心**问题. 最小生成树的Kruskal算法即可用拟阵证明.

##### 定义

拟阵$M=(E,I)$是一个满足以下条件的二元组:

* $E$是一个有限集. 称为**基础集** (ground set).
* $I$是由一些$E$的子集组成的**非空**集合. $I$中的所有元素称为**独立集** (independent set).
* $\O\in I$
* **遗传性:** $\forall A^\prime\sub A\sub E$，若$~A\in I$, 则$A^\prime\in I$.
* **增广性 (交换性):** $\forall X,Y\sub I,~|X|>|Y|,$ 存在$x\in X\text \Y$满足$Y\cup\{x\}\in I$.

举个例子. 若$E=\{1,2,3\}$, $I=\{\O,\{1\},\{2\},\{3\},\{1,2\},\{1,3\},\{2,3\}\}$, 则$M=(E,I)$是一个拟阵. 诸如$\{1\},\{2,3\},\{1,2\}$的集合是独立集. (由下面的模型可知, 这是组合拟阵$U_{2,3}$)

##### 相关定义

* **基:** 极大的独立集.
* **回路:** 极小的不独立集.
* **基交换性:** 令$B$为基的集合 (显然$B\ne \O$). 如果$X,Y\in B,~X\ne Y,~a\in X\text\Y$, 那么存在$b\in Y\text\X$满足$X\text\\\{a\}\cup\{b\}\in B$.
  * 由此可证明所有基的大小相同.
* **秩:** 基的大小.

##### 相关模型

* **线性拟阵:** 令$A$为一个$n\times m$的矩阵, $S\sub[1,n]$. $S\in I$当且仅当$S$中所有元素对应$A$中的行是线性无关的. 定义$E=[1,n]$. 则$M=(E,I)$是一个拟阵.
* **组合拟阵$U_{k,n}$:** 若$|E|=n,S\sub E,S\in I\iff |S|\le k$, 则$U_{k,n}=(E,I)$是拟阵. 
* **环拟阵:** 设图$G=(V,E)$是一个无向图. 设$S\sub E$. 若$S\in I$当且仅当$S$表示一个无环图 (森林), 则$M=(E,I)$是拟阵. 此时$M$的基是$G$的生成树, 回路是$G$的环.
* **匹配拟阵:** 无向图$G=(V,E)$中, 设$S\sub V$. 若$S\in I$当且仅当$S$中的点可以被完全匹配 则$M=(E,I)$是拟阵.

##### 拟阵在贪心算法中的应用

令拟阵$M=(E,I)$.

假设$E$中的每一个元素带权.

我们可以用贪心计算出$M$的最大权的基.

```python
def MaximumWeightBasis(E,I): # 拟阵M=(E,I)
    X=sorted(E,reverse=1) # 按照权值降序排序
    G=set()
    for x in X: # 从大到小尝试加入独立集
        if G|{x} in I: # 如果G并{x}是独立集, 直接将x加入G
            G.add(x)
    return G
```

假设我们可以在$O(f(n))$时间内判断独立性, 则算法复杂度为$O(n\log n+nf(n))$.

例如, Kruskal算法中, 我们使用并查集维护连通性. 此时$f(n)=O(\log n)$.